<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Campus Study Spots</title>
    <style>
      #map {
        height: 100vh;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    
    <script src="config.js"></script>

    <!-- Dynamically load the Google Maps JavaScript API -->
    <script>
      (function () {
        const script = document.createElement("script");
        script.src =
          "https://maps.googleapis.com/maps/api/js?key=" +
          GOOGLE_MAPS_API_KEY +
          "&callback=initMap&v=weekly&solution_channel=GMP_CCS_geolocation_v2";
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      })();

      // Callback function called once Google Maps API is loaded
      function initMap() {
        function createMap(center) {
          const map = new google.maps.Map(document.getElementById("map"), {
            center: center,
            zoom: 16,
          });

          // Add a marker at the center
          new google.maps.Marker({
            position: center,
            map: map,
            color: "blue",
            title: "You are here",
          });
        }

        // Try to get user's current location
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const userLocation = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };
              createMap(userLocation);
            },
            (error) => {
              console.warn("Geolocation failed, using fallback location.");
              const fallback = { lat: 36.9918, lng: -122.0585 }; // UCSC fallback
              createMap(fallback);
            }
          );
        } else {
          // Browser doesn't support geolocation
          const fallback = { lat: 36.9918, lng: -122.0585 };
          createMap(fallback);
        }
      }
    </script>
  </body>
</html>
